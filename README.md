Four datasets are required for TF kinetic predictions:

1.	BioGRID database .tab3 formatted file version 4.4.207, downloaded from BioGRID file repository (https://downloads.thebiogrid.org/BioGRID)
2.	Bursting data generated by CRISPRburst imaging, burstingData.txt file available on GitHub.
3.	Full human TF database from Lambert et al (PMID:29425488, Document S1, Table S1), downloaded as .txt formatted file from http://humantfs.ccbr.utoronto.ca/download.php
4.	RNA-seq data for HeLa cell line (RNA HPA cell line gene data, rna_celline.tsv, filtered on “Cell line” column to include only “HeLa” entries), from a public RNA-seq dataset via Human Protein Atlas cell line data (PMID:33149304).
 	
BioGRID database was downloaded from the BioGRID file repository (https://downloads.thebiogrid.org/BioGRID) as a .tab3 formatted file. 

The analysis pipeline consists of the following steps. The names in blue correspond to separate functions of the script, available on GitHub, https://github.com/timotheelionnet/burstingPrediction.

Data Import
The BioGRID data is used to generate a list of all interactions between all transcription factors: from the .tab3 format BioGRID downloaded file, all physical interactions between human proteins are collected and output as a 2 column list, where the first column is the gene symbol of the bait and the second column is the gene symbol of the hit. The same bait/hit gene pair might appear multiple times in the list if there are multiple evidences for that physical interaction in BioGRID (i.e. the bait/hit gene pair appears in distinct datasets curated within BioGRID).

Building and pruning the Interaction Matrix
The 2-column interaction list is pruned to include only interactions where at least one partner is a transcription factor. Proteins are called Transcription Factors if they are as either members of the Lambert et al TF database, and/or have been characterized by CRISPRburst. 
An interaction matrix with n rows (corresponding to the number of TFs) and m columns (corresponding to the number of interactors) is initialized with zeros, and then populated with the number of evidences for each TF-interactor pair present in the pruned list. Each TF is set to interact with himself a number of times equal to the maximum number of evidence that the TF has for any other interactor.
The interaction matrix is pruned to remove interactors that do not make interactions with at least one CRISPRburst-characterized TF and at least one non-characterized TF (this is necessary to provide training information relevant to predictions outside the characterized set of TFs). TFs and interactors that make fewer than 5 interactions in total are also removed from the matrix.

Selection of genes based on expression in HeLa cells 
Interactor genes are classified based on their expression in HeLa cells. Using RNA-seq data for HeLa cells (from a public RNA-seq dataset via Human Protein Atlas cell line data), all genes with RNA expression levels above a log(pTPM+1) threshold of 0.1 are considered expressed in HeLa cells. Interactors under the threshold are excluded from the model and the corresponding columns deleted from the interaction matrix.

 
At this step the interaction matrix is finished being pruned for training. 

Normalization of the Interaction Matrix
In order to avoid biases between highly studied TFs (exhibiting exhaustive interaction data in BioGRID) and under-studied TFs (with sparse BioGRID interactions), we normalize the interaction matrix. First the interactions of each TF are normalized (z-score transform across each row); second, those TF-normalized interactions are z-score transformed per interactor (z-score transform across each column). We verified that other normalization strategies (e.g. dividing each TF interactions by the maximum evidence observed across interactors, or the sum of evidences observed for all interactors) did not substantially impact the model results.

Building the regression model
We then train the regression model on a training set drawn from TFs characterized by CRISPRburst. 
First, we prune interactors separately for the models predicting active fraction and intensity, keeping only in the training the interactors making more than a minimum number of interactions overall. 
Then we train two Partial Least-Squares (PLS) regression models using either the activity or intensity measured for characterized TFs and the matched TF interaction data.
Additional regression approaches were explored including support vector machine (SVM) regression and generalized additive model (GAM) regression. Tree based random forest classifiers were also tested for assigning TFs into clusters based on their predicted kinetic signatures. These approaches yielded similar performance metrics and identified similar interactors as most predictive, however due to the direct interpretability of linear regression models while achieving good performance metrics, we chose PLS regression.  
The hyperparameters (interaction thresholds and number of PLS components) used for each model are obtained from optimization across a range of values, using cross validation with characterized TF data. We use four and five components for PLS component for active fraction and intensity modeling respectively; minimum number of interactions per interactor of 253 and 40 for active fraction and intensity modeling respectively. 

Predictions of TF kinetic signatures
We apply the weights assigned by the models to each interactor protein to predict kinetic signatures for each non-characterized TF based on its interaction data. This results in a predicted effect for both active fraction effect and intensity effect separately. We also extract the 100 top predictors for each kinetic metric using beta values calculated by models for active fraction and intensity fraction. 
In order to assess the robustness of the model to hyperparameter changes, we calculate predicted effects across a range of interaction thresholds (-5 to +5, centered on the optimal thresholds of 253 and 40 for active fraction and intensity). We then compute the standard deviation of each predicted kinetic metric as a measurement of prediction stability across an interaction range.
